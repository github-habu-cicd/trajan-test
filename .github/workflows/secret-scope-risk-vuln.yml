name: Secret Scope Risk - Vulnerable
on:
  pull_request:
  issue_comment:

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - name: Use secret in untrusted trigger
        run: |
          echo "Deploying with secret from fork PR"
          curl -H "Authorization: Bearer ${{ secrets.API_KEY }}" https://api.example.com/data
          echo "Token: ${{ secrets.GITHUB_TOKEN }}" | base64

  many-secrets:
    runs-on: ubuntu-latest
    steps:
      - name: Access many secrets
        env:
          SECRET1: ${{ secrets.SECRET1 }}
          SECRET2: ${{ secrets.SECRET2 }}
          SECRET3: ${{ secrets.SECRET3 }}
          SECRET4: ${{ secrets.SECRET4 }}
          SECRET5: ${{ secrets.SECRET5 }}
          SECRET6: ${{ secrets.SECRET6 }}
        run: |
          echo "Using secrets: $SECRET1, $SECRET2, $SECRET3"
          echo "And more: $SECRET4, $SECRET5, $SECRET6"
